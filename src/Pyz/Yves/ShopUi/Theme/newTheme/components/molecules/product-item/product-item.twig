{% extends molecule('product-item', '@SprykerShop:ShopUi') %}

{% block extraClass %}
	{{ config.jsName }}
{% endblock %}

{% block body %}
{# <a name="" id="demoBtn" class="btn btn-primary" href="#" role="button">BTN</a> #}
{# <h1>{{data.loopStatus}}</h1> #}
	<div class="{{ config.name }}__container">
		<div class="{{ config.name }}__image-wrap">
			{% block imageContainer %}
				{{ parent() }}
			{% endblock %}

			{{ block('labels') }}

			<div class="{{ config.name }}__overlay-container">
				{% block colors %}
					{% widget 'ProductGroupColorWidget' args [data.idProductAbstract, data.product.selectedAttributes ?? []] use view('product-item-color-selector', 'ProductGroupWidget') with {
                        data: {
                            parentJsName: config.jsName,
                            parentName: config.name,
                        },
                    } only %}{% endwidget %}
				{% endblock %}

				{% set isColorSelectorExist = block('colors') | spaceless %}

				{% block ajaxAddToCart %}
					{# testCode #}
					{% include molecule('quick-view') with {
						data :{
						status: data.loopStatus
					}
					 } only %}

					{# end testCode #}
					{% if data.product is iterable and can('SeeAddToCartPermissionPlugin') %}
						{% set isColorSelectorExist = isColorSelectorExist ?? false %}
						{% set ajaxButtonClasses = 'button button--expand button--large button--reset-min-width button--reset-border-radius' %}
						{% set ajaxButtonExtraAttributes = {} %}
						{% set ajaxAddToCartExtraClasses = not isColorSelectorExist ? config.name ~ '__overlay-container-col' %}

						{% block ajaxAddToCartInner %}
							{% widget 'ProductAbstractAddToCartButtonWidget' args [data.product] with {
                                data: {
                                    buttonClasses: ajaxButtonClasses,
                                    buttonExtraClasses: config.jsName ~ '__ajax-button-add-to-cart js-node-animator__trigger',
                                    isTextHidden: isColorSelectorExist,
                                    extraAttributes: ajaxButtonExtraAttributes,
                                },
                                embed: {
                                    ajaxAddToCartExtraClasses: ajaxAddToCartExtraClasses,
                                },
                            } only %}
							{% block ajaxButton %}
								{% set extraClasses = embed.ajaxAddToCartExtraClasses %}
								{{ parent() }}
							{% endblock %}
							{% endwidget %}
						{% endblock %}
					{% endif %}
				{% endblock %}
			</div>
		</div>

		{% block content %}
			{# testCode #}
			<!-- Modal QuickView -->
			{# Added loopStatus #}
				<div class="modal" id="exampleModal{{data.loopStatus}}" tabindex="-1" aria-labelledby="exampleModalLabel{{data.loopStatus}}" aria-hidden="true"> <div class="modal-dialog modal-lg">
					<div class="modal-content">
						<div class="modal-header">
							<h3 class="modal-title fs-5" id="exampleModalLabel{{data.loopStatus}}">{{ block('title') }}</h3>
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body">
							{# <img src="{{data.product.images[0].external_url_small}}" class="rounded float-start" style="display: block; width: 30%;"> #}

							{{ block('image') }}
                            {{ parent() }}
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
							<a href="{{ data.url }}" class="btn btn-dark">View product</a>
						</div>
					</div>
				</div>
			</div>

			{# End testCode #}
			<a href="{{ data.url }}" class="{{ config.name }}__info {{ config.jsName }}__link-detail-page grid grid--justify grid--top grid--no-wrap">
				{% if data.name %}
					<div class="col col--sm-12 col--md-8">
						{{ block('title') }}
					</div>
				{% endif %}

				<div class="col col--sm-12 col--md-4 text-right">
					{{ block('price') }}
				</div>
			</a>

			<div class="{{ config.name }}__review" itemscope itemtype="http://schema.org/AggregateRating" itemprop="aggregateRating">
				{{ block('rating') }}
			</div>

			<meta class="{{ config.jsName }}__sku" itemprop="sku" content="{{ data.metaSku }}">
		{% endblock %}
	</div>
{% endblock %}

{% block image %}
	{% set extraClass = '' %}
	{% set linkExtraClass = '' %}
	{% set modifiers = ['spaceless'] %}

	{% block productThumbnail %}
		<a itemprop="url" class="{{ config.name }}__overlay {{ config.jsName }}__link-detail-page {{ linkExtraClass }}" href="{{ data.url }}">
			{{ parent() }}
		</a>
	{% endblock %}
{% endblock %}
